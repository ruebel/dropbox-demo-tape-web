{"version":3,"sources":["useLocalStorage.js","cacheContext.js","parseQueryString.js","dropboxContext.js","useUsers.js","utils.js","dropxboxUtils.js","Explorer/fileUtils.js","usePlaylists.js","usePlaylist.js","audioContext.js","constants.js","theme.js","Button.js","ButtonLink.js","TextInput.js","Auth.js","Explorer/Breadcrumb.js","Explorer/BreadcrumbTrail.js","Explorer/Entry.js","List.js","Spacer.js","Loader.js","Explorer/SortableHeader.js","Explorer/useFiles.js","Explorer/index.js","AddPlaylist.js","Link.js","Playlists.js","Home.js","Avatar.js","Main/Header.js","IconButton.js","Main/Player/utils.js","Main/Player/Position.js","Main/Player/SongDetails.js","Main/Player/Player.js","Main/Main.js","ConfirmationButton.js","PlaylistHeader.js","Playlist/Track.js","Playlist/TrackList.js","Playlist/index.js","Tracks.js","App.js","serviceWorker.js","index.js"],"names":["useLocalStorage","key","initialValue","useState","item","window","localStorage","getItem","JSON","parse","error","console","log","storedValue","setStoredValue","value","valueToStore","Function","setItem","stringify","CacheContext","createContext","CacheProvider","children","initialState","setLocalStorage","state","setState","getValue","setValue","newState","resetCache","stateToLoad","Provider","useCache","context","useContext","undefined","Error","parseQueryString","str","ret","Object","create","trim","replace","split","forEach","param","parts","shift","val","length","join","decodeURIComponent","Array","isArray","push","DropboxContext","React","DropboxProvider","authUrl","cache","clientId","setClientId","currentUser","setCurrentUser","setError","accessToken","setAccessToken","authHref","setAuthHref","dbx","current","Dropbox","href","getAuthenticationUrl","a","usersGetCurrentAccount","user","getCurrentUser","isAuthenticated","Boolean","onClearClientId","onLogout","onSaveClientId","parseAcessToken","url","access_token","location","hash","useDropbox","useUsers","isLoading","setIsLoading","users","setUsers","userIds","usersToFetch","filter","userId","usersGetAccountBatch","account_ids","results","saveUsers","updatedUsers","reduce","acc","account_id","data","fetchUsers","getPlaylistId","playlist","meta","id","removeExtension","fileName","substring","lastIndexOf","updateItemInListById","list","getId","newItem","map","l","uploadFile","path","filesUpload","autorename","contents","mode","mute","getExtension","name","pop","getModifiedBy","entry","sharing_info","modified_by","getModifiedUsersFromEntries","entries","Set","isAudioFile","includes","isFolder","isAudioFileOrFolder","isFile","transformFile","file","isPlaylist","path_display","type","getFiles","folder","showFiles","filesListFolder","cursor","hasMore","payload","usePlaylists","forceRefresh","playlists","setPlaylists","savePlaylistLocally","filesDelete","path_lower","updatedPlaylists","p","savePlaylists","sortedPlaylists","sort","b","title","localeCompare","isNew","updatedList","useEffect","fetchPlaylists","filesSearch","query","matches","Promise","all","m","filesDownload","metadata","r","resolve","fr","FileReader","addEventListener","e","text","srcElement","result","readAsText","fileBlob","rawPlaylists","onCreatePlaylist","onDeletePlaylist","onSavePlaylist","usePlaylist","playlistId","find","onDelete","onSave","updatedPlaylist","AudioContext","audioStates","defaultState","duration","trackId","reducer","action","AudioProvider","useReducer","dispatch","audioRef","useRef","useMemo","trackIndex","tracks","findIndex","track","hasNext","hasPrevious","onNext","onStop","player","target","filesGetTemporaryLink","fileLink","setAttribute","link","play","pause","currentTime","updatePlayer","onPause","onPlay","onPrevious","onResume","onSeek","positionMs","subscribeToProgress","callback","ref","useAudio","HOME","color","background","backgroundLight","disabled","inherit","primary","secondary","success","transparent","white","highlight","bgHighlight","typography","base","css","sub","space","small","medium","large","transition","styled","button","theme","Base","ButtonLink","props","as","to","Link","errorStyle","span","StyledInput","input","Title","div","Wrapper","label","hasError","TextInput","onChange","Form","form","Auth","setId","noThrow","Button","onClick","onSubmit","preventDefault","Breadcrumb","Trail","BreadcrumbTrail","onSort","trail","i","pathArray","subPath","slice","Inner","Name","Subtitle","isSelected","Entry","Icon","CheckBox","Folder","Audiotrack","formatDistanceToNow","Date","server_modified","display_name","getKeyDefault","_item","index","EmptyMessage","StyledList","ul","gap","List","emptyMessage","itemRenderer","items","getKey","listItems","defaultProps","height","width","Loader","LinearProgress","Spacer","SortableHeader","sortDir","ExpandMore","ExpandLess","useFiles","sortBy","folderFileMap","setFolderFileMap","files","filesWithUsers","f","fetchFiles","sortedData","dir","sortByTypeAndName","sortByTypeAndModified","sortByTypeAndModifiedBy","Header","Explorer","onPathChange","onSelectionChange","selectedEntries","setFolder","setSortBy","setSortDir","handleClick","some","handleSort","column","ExplorerInner","ExplorerTitle","ExplorerWrapper","h2","AddPlaylist","navigate","artist","setArtist","setTitle","setPath","canSave","Actions","Modified","Updated","Path","Playlist","isPlaying","Playlists","modifiedBy","formatRelative","Home","Image","img","size","Avatar","initials","setHasError","alt","onError","src","h1","UserMenu","anchorEl","setAnchorEl","fontSize","aria-controls","aria-haspopup","currentTarget","abbreviated_name","profile_photo_url","Menu","elevation","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","keepMounted","open","onClose","MenuItem","hideBorder","getMMSSFromMs","millis","totalSeconds","seconds","Math","floor","padWithZero","number","string","toString","LeftTime","isDisabled","Position","audio","position","setPosition","seekPosition","setSeekPosition","isSeeking","setIsSeeking","displayPos","min","max","nextPosition","parseInt","isNaN","onMouseDown","onMouseUp","Artist","TrackName","SongDetails","author","Buttons","Controls","ControlsInner","Player","hasTrack","IconButton","aria-label","Content","main","Main","pathname","ConfirmationButton","message","isConfirming","setIsConfirming","timeout","setTimeout","clearTimeout","onBlur","Info","White","PlaylistHeader","Play","Track","isEditable","full","DragHandle","TrackWrapper","EditableTrackList","memo","onTrackClick","onTrackDelete","playingId","t","draggableId","provided","innerRef","draggableProps","dragHandleProps","prev","next","TrackList","isEditing","onTrackChange","handleDelete","onDragEnd","destination","source","reordered","startIndex","endIndex","from","splice","removed","reorderList","droppableId","droppableProps","placeholder","Add","Inputs","isDirty","setIsDirty","setIsEditing","setPlaylist","handleToggleEdit","Tracks","selectedTracks","setSelectedTracks","useNavigate","playlistUrl","muiTheme","createMuiTheme","palette","blue","App","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.4a4aa130.chunk.js","sourcesContent":["import { useState } from \"react\";\n\nfunction useLocalStorage(key, initialValue) {\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      // Get from local storage by key\n      const item = window.localStorage.getItem(key);\n      // Parse stored json or if none return initialValue\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      // If error also return initialValue\n      console.log(error);\n      return initialValue;\n    }\n  });\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue = value => {\n    try {\n      // Allow value to be a function so we have same API as useState\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      // Save state\n      setStoredValue(valueToStore);\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      // A more advanced implementation would handle the error case\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n\nexport default useLocalStorage;\n","import React, { createContext, useContext, useState } from \"react\";\n\nimport useLocalStorage from \"./useLocalStorage\";\n\nconst CacheContext = createContext();\n\nfunction CacheProvider({ children, initialState = {} }) {\n  const [localStorage, setLocalStorage] = useLocalStorage(\"ddt\", initialState);\n  const [state, setState] = useState(localStorage);\n\n  const getValue = key => {\n    return state[key];\n  };\n\n  const resetCache = (stateToLoad = {}) => {\n    setState({ ...initialState, ...stateToLoad });\n  };\n\n  const setValue = (key, value) => {\n    const newState = {\n      ...state,\n      [key]: value\n    };\n\n    setState(newState);\n    setLocalStorage(newState);\n  };\n\n  const value = {\n    getValue,\n    setValue,\n    resetCache,\n    state\n  };\n\n  return (\n    <CacheContext.Provider value={value}>{children}</CacheContext.Provider>\n  );\n}\n\nfunction useCache() {\n  const context = useContext(CacheContext);\n  if (context === undefined) {\n    throw new Error(\"useCache must be used within a CacheProvider\");\n  }\n  return context;\n}\n\nexport { CacheProvider, useCache };\n","function parseQueryString(str) {\n  var ret = Object.create(null);\n\n  if (typeof str !== \"string\") {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, \"\");\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split(\"&\").forEach(function(param) {\n    var parts = param.replace(/\\+/g, \" \").split(\"=\");\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join(\"=\") : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n}\n\nexport default parseQueryString;\n","import * as React from \"react\";\nimport { Dropbox } from \"dropbox\";\nimport parseQueryString from \"./parseQueryString\";\nimport { useCache } from \"./cacheContext\";\n\nconst DropboxContext = React.createContext();\n\nfunction DropboxProvider({ authUrl, children }) {\n  const cache = useCache();\n  const [clientId, setClientId] = React.useState(cache.getValue(\"clientId\"));\n  const [currentUser, setCurrentUser] = React.useState(\n    cache.getValue(\"currentUser\")\n  );\n  const [error, setError] = React.useState(null);\n  const [accessToken, setAccessToken] = React.useState(\n    cache.getValue(\"accessToken\")\n  );\n  const [authHref, setAuthHref] = React.useState(null);\n  const dbx = React.useRef();\n\n  React.useEffect(() => {\n    if (clientId) {\n      dbx.current = new Dropbox({ accessToken, clientId });\n      const href = dbx.current.getAuthenticationUrl(authUrl);\n      if (href) {\n        setAuthHref(href);\n      } else {\n        setError(\"Invalid Dropbox Id\");\n      }\n    }\n    // eslint-disable-next-line\n  }, [clientId]);\n\n  React.useEffect(() => {\n    async function getCurrentUser() {\n      const user = await dbx.current.usersGetCurrentAccount();\n      setCurrentUser(user);\n      cache.setValue(\"currentUser\", user);\n    }\n\n    if (accessToken && !currentUser) {\n      getCurrentUser();\n    }\n    // eslint-disable-next-line\n  }, [accessToken]);\n\n  function onClearClientId() {\n    setError(null);\n    cache.setValue(\"clientId\", null);\n    setClientId(null);\n  }\n\n  function onLogout() {\n    setAccessToken(\"\");\n    setCurrentUser(null);\n    cache.resetCache({ clientId });\n  }\n\n  function onSaveClientId(clientId) {\n    setError(null);\n    cache.setValue(\"clientId\", clientId);\n    setClientId(clientId);\n  }\n\n  function parseAcessToken(url) {\n    const { access_token } = parseQueryString(window.location.hash);\n    dbx.current = new Dropbox({ accessToken: access_token });\n    setAccessToken(access_token);\n    cache.setValue(\"accessToken\", access_token);\n  }\n\n  const value = {\n    accessToken,\n    authHref,\n    clientId,\n    currentUser,\n    dbx: dbx.current,\n    error,\n    isAuthenticated: Boolean(accessToken),\n    onClearClientId,\n    onLogout,\n    onSaveClientId,\n    parseAcessToken\n  };\n\n  return (\n    <DropboxContext.Provider value={value}>{children}</DropboxContext.Provider>\n  );\n}\n\nfunction useDropbox() {\n  const context = React.useContext(DropboxContext);\n  if (context === undefined) {\n    throw new Error(\"useCache must be used within a DropboxContext\");\n  }\n  return context;\n}\n\nexport { DropboxProvider, useDropbox };\n","import { useState } from \"react\";\n\nimport { useCache } from \"./cacheContext\";\nimport { useDropbox } from \"./dropboxContext\";\n\nfunction useUsers() {\n  const cache = useCache();\n  const { dbx, isAuthenticated } = useDropbox();\n  const [isLoading, setIsLoading] = useState(false);\n  const [users, setUsers] = useState(cache.getValue(\"users\") || {});\n\n  async function fetchUsers(userIds) {\n    // Filter users down to users we don't already have info on\n    const usersToFetch = userIds.filter(userId => !users[userId]);\n\n    if (usersToFetch.length > 0 && dbx && isAuthenticated) {\n      setIsLoading(true);\n\n      try {\n        // Get user info of all unknown users\n        const results = await dbx.usersGetAccountBatch({\n          /* eslint-disable camelcase */\n          account_ids: usersToFetch\n        });\n\n        // Update dictionary\n        const updatedUsers = results.reduce(\n          (acc, user) => ({\n            ...acc,\n            [user.account_id]: user\n          }),\n          users\n        );\n\n        // Save in cache and in state\n        saveUsers(updatedUsers);\n        setIsLoading(false);\n\n        return updatedUsers;\n      } catch (exception) {\n        console.error(exception);\n      }\n    }\n\n    return users;\n  }\n\n  function saveUsers(updatedUsers) {\n    // Save in state and to cache\n    setUsers(updatedUsers);\n    cache.setValue(\"users\", updatedUsers);\n  }\n\n  return {\n    data: users,\n    isLoading,\n    fetchUsers\n  };\n}\n\nexport default useUsers;\n","export function getPlaylistId(playlist) {\n  return playlist.meta.id;\n}\n\nexport function removeExtension(fileName = \"\") {\n  return fileName.substring(0, fileName.lastIndexOf(\".\"));\n}\n\nexport function reorderList(list, startIndex, endIndex) {\n  const result = Array.from(list);\n  const [removed] = result.splice(startIndex, 1);\n  result.splice(endIndex, 0, removed);\n\n  return result;\n}\n\nexport function updateItemInListById(list, id, getId, newItem) {\n  return list.map(l => (getId(l) === id ? newItem : l));\n}\n","/**\n * Upload a file to dropbox\n */\nexport async function uploadFile(dbx, data, path) {\n  // Upload playlist to dropbox (dropbox will return new metadata)\n  const meta = await dbx.filesUpload({\n    // Do not rename on conflict\n    autorename: false,\n    // File data to upload\n    contents: JSON.stringify(data),\n    // Overwrite previous version of file (if exists)\n    mode: {\n      \".tag\": \"overwrite\"\n    },\n    // Do not notify users of change\n    mute: true,\n    // Path to file in dropbox\n    path\n  });\n  return meta;\n}\n","/**\n * Get extension from file name\n * @param  {String} name File Name\n * @return {String}      Extension\n */\nexport function getExtension(name = \"\") {\n  return name.split(\".\").pop();\n}\n\nexport function getModifiedBy(entry) {\n  return entry?.sharing_info?.modified_by;\n}\n\n/**\n * Get the modified_by user ids from a list of entries\n * @param  {Array<Object>} entries\n * @return {Array<string>} ids\n */\nexport function getModifiedUsersFromEntries(entries) {\n  return [...new Set(entries.map(getModifiedBy))].filter(Boolean);\n}\n\n/**\n * Returns true if file name is an audio file\n * @param  {String}  name File Name\n * @return {Boolean}      isAudioFile\n */\nexport function isAudioFile(name) {\n  return [\"mp3\", \"m4a\", \"ovw\", \"wav\"].includes(getExtension(name));\n}\n\nexport function isFile(entry) {\n  return entry[\".tag\"] === \"file\";\n}\n\nexport function isFolder(entry) {\n  return entry[\".tag\"] === \"folder\";\n}\n\nexport function isAudioFileOrFolder(entry) {\n  return isFolder(entry) || (isFile(entry) && isAudioFile(entry.name));\n}\n\n/**\n * Returns true if file name is a demo tape playlist\n * @param  {String}  name File Name\n * @return {Boolean}      is playlist\n */\nexport function isPlaylist(name) {\n  return getExtension(name) === \"mix\";\n}\n\n/**\n * Transform dropbox file object shape to shape usable by client\n * @param  {Object} file File object shape from dropbox\n * @return {Object}      Transformed file object\n */\nexport function transformFile(file) {\n  return {\n    ...file,\n    isAudioFile: isAudioFile(file.name),\n    isFolder: file[\".tag\"] === \"folder\",\n    isPlaylist: isPlaylist(file.name),\n    path: file.path_display,\n    type: file[\".tag\"],\n    user: getModifiedBy(file)\n  };\n}\n\nexport async function getFiles(dbx, folder = \"\", showFiles) {\n  // Get folder listing\n  const { cursor, entries, hasMore } = await dbx.filesListFolder({\n    path: folder\n  });\n\n  const payload = {\n    cursor,\n    data: entries\n      .filter(showFiles ? isAudioFileOrFolder : isFolder)\n      .map(transformFile),\n    hasMore,\n    path: folder\n  };\n\n  return payload;\n}\n\nexport function sortByTypeAndName(sortDir) {\n  const dir = sortDir === \"asc\" ? -1 : 1;\n  return function(a, b) {\n    return (\n      (a.type !== b.type && (a.type === \"folder\" || b.type === \"folder\")\n        ? b.type === \"folder\"\n          ? 1\n          : -1\n        : a.name.localeCompare(b.name)) * dir\n    );\n  };\n}\n\nexport function sortByTypeAndModified(sortDir) {\n  const dir = sortDir === \"asc\" ? -1 : 1;\n  return function(a, b) {\n    return (\n      (a.type !== b.type && (a.type === \"folder\" || b.type === \"folder\")\n        ? b.type === \"folder\"\n          ? 1\n          : -1\n        : new Date(b.server_modified) - new Date(a.server_modified)) * dir\n    );\n  };\n}\n\nexport function sortByTypeAndModifiedBy(sortDir) {\n  const dir = sortDir === \"asc\" ? -1 : 1;\n  return function(a, b) {\n    return (\n      (a.type !== b.type && (a.type === \"folder\" || b.type === \"folder\")\n        ? b.type === \"folder\"\n          ? 1\n          : -1\n        : a.user?.name?.display_name.localeCompare(\n            b.user?.name?.display_name\n          )) * dir\n    );\n  };\n}\n","import { useEffect, useState } from \"react\";\n\nimport { useCache } from \"./cacheContext\";\nimport { useDropbox } from \"./dropboxContext\";\nimport useUsers from \"./useUsers\";\nimport { getPlaylistId, updateItemInListById } from \"./utils\";\nimport { uploadFile } from \"./dropxboxUtils\";\nimport {\n  getModifiedBy,\n  getModifiedUsersFromEntries\n} from \"./Explorer/fileUtils\";\n\nfunction usePlaylists({ forceRefresh }) {\n  const cache = useCache();\n  const { dbx, isAuthenticated } = useDropbox();\n  const [isLoading, setIsLoading] = useState(false);\n  const [playlists, setPlaylists] = useState(cache.getValue(\"playlists\") || []);\n  const { fetchUsers } = useUsers();\n\n  useEffect(() => {\n    if (\n      isAuthenticated &&\n      dbx &&\n      !isLoading &&\n      (forceRefresh || playlists.length === 0)\n    ) {\n      setIsLoading(true);\n\n      async function fetchPlaylists() {\n        // Search for playlist files\n        const { matches } = await dbx.filesSearch({\n          path: \"\",\n          query: \".mix\"\n        });\n\n        // Downloaad all files\n        const results = await Promise.all(\n          matches.map(m =>\n            dbx.filesDownload({\n              path: m.metadata.path_display\n            })\n          )\n        );\n\n        // Convert blobs to JSON\n        const rawPlaylists = await Promise.all(\n          results.map(r => {\n            return new Promise(resolve => {\n              const fr = new FileReader();\n\n              fr.addEventListener(\"loadend\", e => {\n                const text = e.srcElement.result;\n                const data = JSON.parse(text);\n                resolve({ data, meta: r });\n              });\n\n              fr.readAsText(r.fileBlob);\n            });\n          })\n        );\n\n        // Get all user ids of users who have modified listed files\n        const userIds = getModifiedUsersFromEntries(results);\n        const users = await fetchUsers(userIds);\n\n        const playlistsWithUsers = (rawPlaylists || []).map(p => ({\n          ...p,\n          meta: {\n            ...p.meta,\n            user: users[getModifiedBy(p.meta)]\n          }\n        }));\n\n        // Save in cache and in state\n        savePlaylists(playlistsWithUsers);\n        setIsLoading(false);\n      }\n\n      fetchPlaylists();\n    }\n    // eslint-disable-next-line\n  }, [dbx, isAuthenticated]);\n\n  async function onCreatePlaylist(path, playlist) {\n    // update file on dropbox\n    const meta = await uploadFile(dbx, playlist, path);\n\n    // save playlist locally\n    savePlaylistLocally(\n      {\n        data: playlist,\n        meta\n      },\n      true\n    );\n\n    return meta.id;\n  }\n\n  async function onDeletePlaylist(playlist) {\n    setIsLoading(true);\n    // delete file on dropbox\n    await dbx.filesDelete({ path: playlist.meta.path_lower });\n\n    // delete playlist locally\n    const updatedPlaylists = playlists.filter(\n      p => p.meta.id !== playlist.meta.id\n    );\n    setPlaylists(updatedPlaylists);\n    cache.setValue(\"playlists\", updatedPlaylists);\n    setIsLoading(false);\n  }\n\n  async function onSavePlaylist(playlist) {\n    // Optimistic local save\n    savePlaylistLocally(playlist);\n\n    // update file on dropbox\n    const meta = await uploadFile(dbx, playlist.data, playlist.meta.path_lower);\n\n    // update meta locally\n    savePlaylistLocally({\n      ...playlist,\n      meta\n    });\n  }\n\n  function savePlaylists(updatedPlaylists = []) {\n    // sort by title\n    const sortedPlaylists = updatedPlaylists.sort((a, b) =>\n      a.data.title.localeCompare(b.data.title)\n    );\n\n    // Save in state and to cache\n    setPlaylists(sortedPlaylists);\n    cache.setValue(\"playlists\", sortedPlaylists);\n  }\n\n  function savePlaylistLocally(playlist, isNew = false) {\n    const updatedList = isNew\n      ? [...playlists, playlist]\n      : updateItemInListById(\n          playlists,\n          getPlaylistId(playlist),\n          getPlaylistId,\n          playlist\n        );\n    savePlaylists(updatedList);\n  }\n\n  return {\n    data: playlists,\n    isLoading,\n    onCreatePlaylist,\n    onDeletePlaylist,\n    onSavePlaylist\n  };\n}\n\nexport default usePlaylists;\n","import usePlaylists from \"./usePlaylists\";\nimport { useDropbox } from \"./dropboxContext\";\n\nfunction usePlaylist({ playlistId }) {\n  const { dbx, isAuthenticated } = useDropbox();\n  const { data, isLoading, onDeletePlaylist, onSavePlaylist } = usePlaylists({\n    dbx,\n    isAuthenticated\n  });\n  const playlist = data.find(p => p.meta.id === playlistId);\n\n  function onSave(updatedPlaylist) {\n    onSavePlaylist(updatedPlaylist);\n  }\n\n  async function onDelete() {\n    if (playlist) {\n      return onDeletePlaylist(playlist);\n    }\n  }\n\n  return {\n    data: playlist,\n    isLoading,\n    onDelete,\n    onSave\n  };\n}\n\nexport default usePlaylist;\n","import React, {\n  createContext,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useReducer\n} from \"react\";\nimport usePlaylist from \"./usePlaylist\";\nimport { useDropbox } from \"./dropboxContext\";\n\nconst AudioContext = createContext();\n\nexport const audioStates = {\n  loading: \"loading\",\n  paused: \"paused\",\n  playing: \"playing\",\n  stopped: \"stopped\"\n};\n\nconst defaultState = {\n  duration: 0,\n  playlistId: null,\n  trackId: null,\n  state: audioStates.stopped\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case \"loaded\":\n      return {\n        ...state,\n        ...action.payload,\n        state: audioStates.playing\n      };\n    case \"pause\":\n      if (state.state === audioStates.playing) {\n        return {\n          ...state,\n          state: audioStates.paused\n        };\n      }\n      return state;\n    case \"play\":\n      return {\n        ...state,\n        ...action.payload,\n        state: audioStates.loading\n      };\n    case \"resume\":\n      return {\n        ...state,\n        state: audioStates.playing\n      };\n    case \"stop\":\n      return {\n        ...state,\n        state: audioStates.stopped\n      };\n    default:\n      throw new Error();\n  }\n}\n\nfunction AudioProvider({ children, initialState = {} }) {\n  const [{ duration, playlistId, state, trackId }, dispatch] = useReducer(\n    reducer,\n    {\n      ...defaultState,\n      ...initialState\n    }\n  );\n  const audioRef = useRef();\n  const { dbx } = useDropbox();\n  const playlist = usePlaylist({ playlistId });\n\n  const { hasNext, hasPrevious, track, trackIndex } = useMemo(() => {\n    const trackIndex = trackId\n      ? playlist?.data?.data.tracks.findIndex(track => track.id === trackId)\n      : playlist?.data?.data\n      ? 0\n      : -1;\n    const track =\n      trackIndex >= 0 ? playlist.data.data.tracks[trackIndex] : null;\n    const hasNext = track\n      ? trackIndex < playlist.data.data.tracks.length - 1\n      : false;\n    const hasPrevious = track ? trackIndex > 0 : false;\n    return {\n      hasNext,\n      hasPrevious,\n      track,\n      trackIndex\n    };\n    // eslint-disable-next-line\n  }, [trackId, playlistId]);\n\n  useEffect(() => {\n    const player = audioRef.current;\n    player.addEventListener(\"playing\", e => {\n      if (state === audioStates.loading) {\n        dispatch({\n          type: \"loaded\",\n          payload: {\n            duration: e.target.duration * 1000\n          }\n        });\n      }\n    });\n\n    player.addEventListener(\"ended\", e => {\n      if (hasNext) {\n        onNext();\n      } else {\n        onStop();\n      }\n    });\n  });\n\n  useEffect(() => {\n    async function updatePlayer() {\n      const player = audioRef.current;\n\n      if (track && state === audioStates.loading) {\n        // This is not a resume so we need to load the file\n        const fileLink = await dbx.filesGetTemporaryLink({\n          path: track.path_lower\n        });\n        player.setAttribute(\"src\", fileLink.link);\n\n        player.play();\n      } else if (track && state === audioStates.playing) {\n        player.play();\n      } else if (state === audioStates.paused) {\n        player.pause();\n      } else if (state === audioStates.stopped) {\n        player.pause();\n        // clear time so we restart at beginning\n        player.currentTime = 0;\n      }\n    }\n\n    updatePlayer();\n    // eslint-disable-next-line\n  }, [state, trackId, playlistId]);\n\n  function onNext() {\n    if (hasNext) {\n      dispatch({\n        type: \"play\",\n        payload: {\n          playlistId,\n          trackId: playlist.data.data.tracks[trackIndex + 1].id\n        }\n      });\n    }\n  }\n\n  function onPrevious() {\n    if (hasPrevious) {\n      dispatch({\n        type: \"play\",\n        payload: {\n          playlistId,\n          trackId: playlist.data.data.tracks[trackIndex - 1].id\n        }\n      });\n    }\n  }\n\n  function subscribeToProgress(callback) {\n    audioRef.current.addEventListener(\"progress\", e => {\n      callback(e.target.currentTime * 1000);\n    });\n  }\n\n  function onPause() {\n    if (state !== audioStates.paused) {\n      dispatch({ type: \"pause\" });\n    }\n  }\n\n  function onPlay({ playlistId, trackId }) {\n    dispatch({ type: \"play\", payload: { playlistId, trackId } });\n  }\n\n  function onResume() {\n    if (state === audioStates.paused) {\n      dispatch({ type: \"resume\" });\n    }\n  }\n\n  function onSeek(positionMs) {\n    if (track) {\n      const player = audioRef.current;\n      player.currentTime = positionMs / 1000;\n    }\n  }\n\n  function onStop() {\n    if (state !== audioStates.stopped) {\n      dispatch({ type: \"stop\" });\n    }\n  }\n\n  const value = {\n    duration,\n    hasNext,\n    hasPrevious,\n    onNext,\n    onPause,\n    onPlay,\n    onPrevious,\n    onResume,\n    onSeek,\n    onStop,\n    playlist,\n    subscribeToProgress,\n    state,\n    track\n  };\n\n  return (\n    <AudioContext.Provider value={value}>\n      {children}\n      <audio ref={audioRef} />\n    </AudioContext.Provider>\n  );\n}\n\nfunction useAudio() {\n  const context = useContext(AudioContext);\n  if (context === undefined) {\n    throw new Error(\"useAudio must be used within a AudioProvider\");\n  }\n  return context;\n}\n\nexport { AudioProvider, useAudio };\n","export const HOME = \"/dropbox-demo-tape-web\";\n","import { css } from \"styled-components\";\n\nconst color = {\n  background: \"#242A31\",\n  backgroundLight: \"#2D323C\",\n  disabled: \"#656565\",\n  error: \"#E7777F\",\n  inherit: \"inherit\",\n  primary: \"#D2D2D2\",\n  secondary: \"#b3b3b3\",\n  success: \"#A1CA7E\",\n  transparent: \"transparent\",\n  white: \"#FFFFFF\"\n};\n\nconst space = 5;\n\nexport default {\n  color: {\n    ...color,\n    highlight: \"#5EB1BF\",\n    bgHighlight: color.primary + \"11\"\n  },\n  typography: {\n    base: css`\n      font-size: 16px;\n    `,\n    sub: css`\n      font-size: 14px;\n      font-weight: 400;\n    `\n  },\n  space: {\n    small: space,\n    medium: space * 2,\n    large: space * 4\n  },\n  transition: \"all 250ms ease-in\"\n};\n","import styled from \"styled-components\";\n\nexport default styled.button`\n  background-color: ${p => p.theme.color.background};\n  border-radius: 10px;\n  border: 1px solid ${p => p.theme.color.white};\n  color: ${p => p.theme.color.white};\n  cursor: pointer;\n  display: flex;\n  font-size: 14px;\n  justify-content: center;\n  outline: none;\n  padding: 10px 20px;\n  text-transform: uppercase;\n\n  transition: ${p => p.theme.transition};\n\n  :hover,\n  :focus {\n    background-color: ${p => p.theme.color.white};\n    color: ${p => p.theme.color.background};\n  }\n\n  ${p =>\n    p.disabled\n      ? `\n    color: ${p.theme.color.disabled};\n    cursor: unset;\n    border-color: ${p.theme.color.disabled};\n\n    :hover, :focus {\n      background-color: ${p.theme.color.background};\n      color: ${p.theme.color.disabled};\n    }\n  `\n      : \"\"}\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { Link } from \"@reach/router\";\n\nconst Base = styled.a`\n  background-color: ${p => p.theme.color.background};\n  border-radius: 10px;\n  border: 1px solid ${p => p.theme.color.white};\n  color: ${p => p.theme.color.white};\n  cursor: pointer;\n  display: flex;\n  font-size: 14px;\n  justify-content: center;\n  padding: 10px 20px;\n  text-decoration: none;\n  text-transform: uppercase;\n  transition: ${p => p.theme.transition};\n\n  :hover {\n    background-color: ${p => p.theme.color.white};\n    color: ${p => p.theme.color.background};\n  }\n\n  ${p =>\n    p.disabled\n      ? `\n  color: ${p.theme.color.disabled};\n  cursor: unset;\n  border-color: ${p.theme.color.disabled};\n\n  :hover {\n    background-color: ${p.theme.color.background};\n    color: ${p.theme.color.disabled};\n  }\n`\n      : \"\"}\n`;\n\nfunction ButtonLink(props) {\n  return <Base as={props.to ? Link : undefined} {...props} />;\n}\n\nexport default ButtonLink;\n","import React from \"react\";\nimport styled, { css } from \"styled-components\";\n\nconst errorStyle = css`\n  border-color: ${p => p.theme.color.error};\n  color: ${p => p.theme.color.error};\n`;\n\nconst Error = styled.span`\n  ${errorStyle}\n  font-size: 14px;\n  font-weight: 700;\n`;\n\nconst StyledInput = styled.input`\n  background-color: ${p => p.theme.color.background};\n  border: 1px solid ${p => p.theme.color.primary};\n  border-radius: 10px;\n  color: inherit;\n  font-size: 16px;\n  line-height: 37px;\n  outline: none;\n  padding: 2px 15px;\n  width: 100%;\n`;\n\nconst Title = styled.div`\n  background-color: ${p => p.theme.color.background};\n  font-size: 12px;\n  font-weight: 600;\n  left: 10px;\n  padding: 0 5px;\n  position: absolute;\n  top: -6px;\n`;\n\nconst Wrapper = styled.label`\n  color: ${p => p.theme.color.secondary};\n  position: relative;\n\n  :focus-within {\n    color: ${p => p.theme.color.white};\n  }\n\n  ${p => (p.hasError ? errorStyle : \"\")}\n`;\n\nfunction TextInput({ error, hasError, onChange, title, value, ...props }) {\n  return (\n    <Wrapper hasError={hasError}>\n      <StyledInput\n        {...props}\n        hasError={hasError}\n        onChange={e => onChange(e.target.value)}\n        type=\"text\"\n        value={value}\n      />\n      <Title>{title}</Title>\n      {error && <Error>{error}</Error>}\n    </Wrapper>\n  );\n}\n\nexport default TextInput;\n","import React, { Fragment, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { Redirect } from \"@reach/router\";\n\nimport { useDropbox } from \"./dropboxContext\";\nimport { HOME } from \"./constants\";\n\nimport Button from \"./Button\";\nimport ButtonLink from \"./ButtonLink\";\nimport TextInput from \"./TextInput\";\n\nconst Form = styled.form`\n  display: grid;\n  grid-gap: 20px;\n  position: relative;\n  width: 300px;\n`;\n\nconst Wrapper = styled.div`\n  align-items: center;\n  display: grid;\n  grid-gap: 20px;\n  justify-content: center;\n  padding: 40px;\n`;\n\nfunction Auth() {\n  const {\n    authHref,\n    clientId,\n    error,\n    isAuthenticated,\n    parseAcessToken,\n    onClearClientId,\n    onSaveClientId\n  } = useDropbox();\n  const [id, setId] = useState(clientId || \"\");\n\n  function handleIdChange(value) {\n    setId(value);\n  }\n\n  function handleSubmit(e) {\n    if (id) {\n      onSaveClientId(id);\n      setId(\"\");\n    }\n    e.preventDefault();\n    return false;\n  }\n\n  if (!isAuthenticated && window.location.hash.includes(\"access_token\")) {\n    parseAcessToken();\n  }\n\n  if (isAuthenticated) {\n    return <Redirect noThrow={true} to={HOME} />;\n  }\n\n  return (\n    <Wrapper>\n      <h1>Welcome</h1>\n      {clientId ? (\n        <Fragment>\n          <ButtonLink disabled={!clientId} href={authHref}>\n            Authenticate With Dropbox\n          </ButtonLink>\n          <Button onClick={onClearClientId}>Clear Dropbox Client Id</Button>\n        </Fragment>\n      ) : (\n        <Form onSubmit={handleSubmit}>\n          <TextInput\n            error={error}\n            hasError={error}\n            onChange={handleIdChange}\n            title=\"Dropbox Client Id\"\n            value={id}\n          />\n          <Button disabled={!id} type=\"submit\">\n            Save\n          </Button>\n        </Form>\n      )}\n    </Wrapper>\n  );\n}\n\nexport default Auth;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst Wrapper = styled.button`\n  background-color: transparent;\n  border: none;\n  color: ${p => p.theme.color.primary};\n  cursor: pointer;\n  font-size: 14px;\n  font-weight: 700;\n  padding: 10px;\n  outline: none;\n\n  :hover,\n  :focus {\n    color: ${p => p.theme.color.highlight};\n  }\n`;\n\nconst Breadcrumb = ({ name = \"Home\", onClick, path }) => {\n  return <Wrapper onClick={() => onClick(path)}>{name}</Wrapper>;\n};\n\nexport default Breadcrumb;\n","import React, { Fragment } from \"react\";\nimport styled from \"styled-components\";\nimport ChevronRight from \"@material-ui/icons/ChevronRight\";\n\nimport Breadcrumb from \"./Breadcrumb\";\n\nconst Trail = styled.div`\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  padding-left: 10px;\n`;\n\nfunction BreadcrumbTrail({ onClick, onSort, path = \"\" }) {\n  const trail = path.split(\"/\").map((folder, i, pathArray) => {\n    const subPath = pathArray.slice(0, i + 1).join(\"/\");\n    return (\n      <Fragment key={i}>\n        {i !== 0 && <span>/</span>}\n        <Breadcrumb name={folder || \"Home\"} onClick={onClick} path={subPath} />\n      </Fragment>\n    );\n  });\n\n  return (\n    <Trail>\n      <ChevronRight /> {trail}\n    </Trail>\n  );\n}\n\nexport default BreadcrumbTrail;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport formatDistanceToNow from \"date-fns/formatDistanceToNow\";\nimport Audiotrack from \"@material-ui/icons/Audiotrack\";\nimport CheckBox from \"@material-ui/icons/CheckBox\";\nimport Folder from \"@material-ui/icons/Folder\";\n\nconst Inner = styled.div`\n  align-items: center;\n  display: grid;\n  grid-gap: 20px;\n  grid-template-columns: 20px 1fr 0.5fr 0.5fr;\n`;\n\nconst Name = styled.span`\n  ${p => p.theme.typography.base}\n`;\n\nconst Subtitle = styled.span`\n  ${p => p.theme.typography.sub}\n`;\n\nconst Wrapper = styled.button`\n  background-color: ${p =>\n    p.theme.color[p.isSelected ? \"bgHighlight\" : \"background\"]};\n  border: none;\n  border-top: 1px solid ${p => p.theme.color.bgHighlight};\n  color: ${p => p.theme.color[p.isSelected ? \"highlight\" : \"inherit\"]};\n  cursor: pointer;\n  height: 61px;\n  outline: none;\n  padding: ${p => p.theme.space.medium}px ${p => p.theme.space.large}px;\n  text-align: left;\n  width: 100%;\n\n  :hover {\n    background-color: ${p => p.theme.color.primary}11;\n  }\n`;\n\nfunction Entry({ entry, onClick, isSelected = false }) {\n  const Icon = isSelected ? CheckBox : entry.isFolder ? Folder : Audiotrack;\n\n  return (\n    <Wrapper isSelected={isSelected} onClick={() => onClick(entry)}>\n      <Inner>\n        <Icon />\n        <Name>{entry.name}</Name>\n        {entry.type === \"file\" && (\n          <Subtitle>\n            {formatDistanceToNow(new Date(entry.server_modified))} ago\n          </Subtitle>\n        )}\n        {entry.type === \"file\" && (\n          <Subtitle>{entry.user?.name?.display_name}</Subtitle>\n        )}\n      </Inner>\n    </Wrapper>\n  );\n}\n\nexport default Entry;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst getKeyDefault = (_item, index) => index;\n\nconst EmptyMessage = styled.div`\n  ${p => p.theme.typography.base}\n  color: ${p => p.theme.color.secondary};\n  font-size: 18px;\n  padding: 20px;\n`;\n\nconst gapStyle = gap =>\n  gap\n    ? `\n        display: grid;\n        grid-gap: ${gap}px;\n      `\n    : \"\";\n\nconst StyledList = styled.ul`\n  liststyletype: none;\n  margin: 0;\n  marginblockend: 0;\n  marginblockstart: 0;\n  padding: 0;\n  paddinginlinestart: 0;\n  webkitmarginafter: 0;\n  webkitmarginbefore: 0;\n  webkitpaddingstart: 0;\n  ${p => gapStyle(p.gap)}\n`;\n\nfunction List({\n  emptyMessage,\n  isLoading,\n  itemRenderer,\n  items,\n  gap,\n  getKey = getKeyDefault\n}) {\n  if (!isLoading && items.length === 0 && emptyMessage) {\n    return <EmptyMessage>{emptyMessage}</EmptyMessage>;\n  }\n\n  const listItems = items.map((item, i) => (\n    <li key={getKey(item, i)}>{itemRenderer(item, i)}</li>\n  ));\n\n  return <StyledList gap={gap}>{listItems}</StyledList>;\n}\n\nList.defaultProps = {\n  getKey: getKeyDefault\n};\n\nexport default List;\n","import styled from \"styled-components\";\n\nexport default styled.div`\n  height: ${p => p.height};\n  width: ${p => p.width};\n`;\n","import React from \"react\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport styled from \"styled-components\";\n\nimport Spacer from \"./Spacer\";\n\nconst Wrapper = styled.div`\n  margin-bottom: -4px;\n`;\n\nfunction Loader({ isLoading }) {\n  return (\n    <Wrapper>\n      {isLoading ? <LinearProgress /> : <Spacer height=\"4px\" />}\n    </Wrapper>\n  );\n}\n\nexport default Loader;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport ExpandLess from \"@material-ui/icons/ExpandLess\";\nimport ExpandMore from \"@material-ui/icons/ExpandMore\";\n\nconst Wrapper = styled.button`\n  align-items: center;\n  background-color: transparent;\n  border: none;\n  color: ${p => p.theme.color.primary};\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 27px;\n  margin: 0;\n  outline: none;\n  padding: 0;\n\n  :hover,\n  :focus {\n    color: ${p => p.theme.color.highlight};\n  }\n`;\n\nfunction SortableHeader({ children, onClick, sortDir }) {\n  const Icon =\n    sortDir === \"asc\" ? ExpandMore : sortDir === \"desc\" ? ExpandLess : null;\n\n  return (\n    <Wrapper onClick={onClick}>\n      <span>{children}</span>\n      {Icon && <Icon />}\n    </Wrapper>\n  );\n}\n\nexport default SortableHeader;\n","import { useEffect, useState } from \"react\";\nimport { useDropbox } from \"../dropboxContext\";\nimport useUsers from \"../useUsers\";\nimport {\n  getFiles,\n  getModifiedBy,\n  getModifiedUsersFromEntries,\n  sortByTypeAndName,\n  sortByTypeAndModified,\n  sortByTypeAndModifiedBy\n} from \"./fileUtils\";\n\nfunction useFiles({\n  folder = \"\",\n  showFiles = false,\n  sortBy = \"\",\n  sortDir = \"\"\n}) {\n  const { dbx } = useDropbox();\n  const [folderFileMap, setFolderFileMap] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const { fetchUsers } = useUsers();\n\n  useEffect(() => {\n    async function fetchFiles() {\n      setIsLoading(true);\n      const files = await getFiles(dbx, folder, showFiles);\n\n      // Get all user ids of users who have modified listed files\n      const userIds = getModifiedUsersFromEntries(files.data);\n      const users = await fetchUsers(userIds);\n\n      const filesWithUsers = {\n        ...files,\n        data: files.data.map(f => ({\n          ...f,\n          user: users[getModifiedBy(f)]\n        }))\n      };\n\n      setFolderFileMap({\n        [folder]: filesWithUsers\n      });\n      setIsLoading(false);\n    }\n\n    if (dbx) {\n      fetchFiles();\n    }\n    // eslint-disable-next-line\n  }, [dbx, folder]);\n\n  const { cursor, data = [], hasMore } = folderFileMap[folder] || {};\n\n  let sortedData = data;\n\n  if (sortBy && sortDir) {\n    if (sortBy === \"name\") {\n      sortedData = data.sort(sortByTypeAndName(sortDir));\n    } else if (sortBy === \"modified\") {\n      sortedData = data.sort(sortByTypeAndModified(sortDir));\n    } else if (sortBy === \"modifiedBy\") {\n      sortedData = data.sort(sortByTypeAndModifiedBy(sortDir));\n    }\n  }\n\n  return {\n    cursor,\n    files: sortedData,\n    folder,\n    hasMore,\n    isLoading\n  };\n}\n\nexport default useFiles;\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport BreadcrumbTrail from \"./BreadcrumbTrail\";\nimport Entry from \"./Entry\";\nimport List from \"../List\";\nimport Loader from \"../Loader\";\nimport SortableHeader from \"./SortableHeader\";\nimport Spacer from \"../Spacer\";\nimport useFiles from \"./useFiles\";\n\nconst Header = styled.div`\n  display: grid;\n  grid-gap: 20px;\n  grid-template-columns: 20px 1fr 0.5fr 0.5fr;\n  padding: 0 20px;\n`;\n\nconst Wrapper = styled.div`\n  display: grid;\n`;\n\nfunction Explorer({\n  onPathChange,\n  onSelectionChange,\n  selectedEntries = [],\n  showFiles = false\n}) {\n  const [folder, setFolder] = useState(\"\");\n  const [sortBy, setSortBy] = useState(\"\");\n  const [sortDir, setSortDir] = useState(\"\");\n  const { files, isLoading } = useFiles({ folder, showFiles, sortBy, sortDir });\n\n  function handleClick(entry) {\n    if (entry.type === \"folder\") {\n      setFolder(entry.path);\n      if (onPathChange) {\n        onPathChange(entry.path);\n      }\n    } else if (showFiles) {\n      if (selectedEntries.some(e => e.id === entry.id)) {\n        onSelectionChange(selectedEntries.filter(e => e.id !== entry.id));\n      } else {\n        onSelectionChange([...selectedEntries, entry]);\n      }\n    }\n  }\n\n  function handleSort(column) {\n    if (column !== sortBy) {\n      setSortBy(column);\n      setSortDir(\"desc\");\n    } else {\n      if (sortDir === \"desc\") {\n        setSortDir(\"asc\");\n      } else {\n        setSortDir(\"\");\n        setSortBy(\"\");\n      }\n    }\n  }\n\n  return (\n    <Wrapper>\n      <BreadcrumbTrail onClick={setFolder} path={folder} />\n      <Spacer height=\"10px\" />\n      <Header>\n        <span />\n        <SortableHeader\n          onClick={() => handleSort(\"name\")}\n          sortDir={sortBy === \"name\" ? sortDir : null}\n        >\n          Name\n        </SortableHeader>\n        <SortableHeader\n          onClick={() => handleSort(\"modified\")}\n          sortDir={sortBy === \"modified\" ? sortDir : null}\n        >\n          Modified\n        </SortableHeader>\n        <SortableHeader\n          onClick={() => handleSort(\"modifiedBy\")}\n          sortDir={sortBy === \"modifiedBy\" ? sortDir : null}\n        >\n          Modified By\n        </SortableHeader>\n      </Header>\n      <Loader isLoading={isLoading} />\n      <List\n        emptyMessage=\"There are no files here\"\n        isLoading={isLoading}\n        items={files}\n        itemRenderer={entry => (\n          <Entry\n            entry={entry}\n            isSelected={selectedEntries.some(\n              e => e.path_lower === entry.path_lower\n            )}\n            onClick={handleClick}\n          />\n        )}\n      />\n    </Wrapper>\n  );\n}\n\nexport default Explorer;\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { HOME } from \"./constants\";\nimport Button from \"./Button\";\nimport ButtonLink from \"./ButtonLink\";\nimport Explorer from \"./Explorer\";\nimport TextInput from \"./TextInput\";\n\nimport usePlaylists from \"./usePlaylists\";\n\nconst ExplorerInner = styled.div`\n  overflow-y: scroll;\n  height: 470px;\n`;\n\nconst ExplorerTitle = styled.div`\n  background-color: ${p => p.theme.color.background};\n  font-size: 12px;\n  font-weight: 600;\n  left: 10px;\n  padding: 0 5px;\n  position: absolute;\n  top: -6px;\n`;\n\nconst ExplorerWrapper = styled.div`\n  border: 1px solid ${p => p.theme.color.primary};\n  border-radius: 10px;\n  max-height: 480px;\n  padding: 5px;\n  position: relative;\n`;\n\nconst Header = styled.div`\n  align-items: center;\n  display: grid;\n  grid-template-columns: 1fr auto auto;\n  grid-gap: 20px;\n  margin-bottom: 20px;\n`;\n\nconst Title = styled.h2``;\n\nconst Wrapper = styled.form`\n  display: grid;\n  grid-gap: 20px;\n  padding: 20px;\n`;\n\nfunction AddPlaylist({ navigate }) {\n  const [artist, setArtist] = useState(\"\");\n  const [title, setTitle] = useState(\"\");\n  const [path, setPath] = useState(\"/\");\n  const { onCreatePlaylist } = usePlaylists({});\n\n  const canSave = !!artist && !!title && !!path;\n\n  async function handleSave(e) {\n    e.preventDefault();\n\n    const playlistId = await onCreatePlaylist(`${path}/${title}.mix`, {\n      artist,\n      title,\n      tracks: []\n    });\n\n    navigate(`/playlist/${playlistId}`);\n\n    return false;\n  }\n\n  return (\n    <Wrapper onSubmit={canSave ? handleSave : undefined}>\n      <Header>\n        <Title>Add Playlist</Title>\n        <Button disabled={!canSave} type=\"submit\">\n          Save\n        </Button>\n        <ButtonLink to={HOME}>Cancel</ButtonLink>\n      </Header>\n      <TextInput onChange={setTitle} title=\"Title\" value={title} />\n      <TextInput onChange={setArtist} title=\"Artist\" value={artist} />\n      <ExplorerWrapper>\n        <ExplorerInner>\n          <Explorer onPathChange={setPath} />\n        </ExplorerInner>\n        <ExplorerTitle>Location</ExplorerTitle>\n      </ExplorerWrapper>\n    </Wrapper>\n  );\n}\n\nexport default AddPlaylist;\n","import styled from \"styled-components\";\nimport { Link } from \"@reach/router\";\n\nexport default styled(Link)`\n  color: ${p => p.theme.color.primary};\n  cursor: pointer;\n  text-decoration: none;\n\n  &:hover {\n    color: ${p => p.theme.color.highlight};\n  }\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport formatRelative from \"date-fns/formatRelative\";\n\nimport ButtonLink from \"./ButtonLink\";\nimport Link from \"./Link\";\nimport List from \"./List\";\nimport Loader from \"./Loader\";\n\nimport usePlaylists from \"./usePlaylists\";\n\nconst Actions = styled.div`\n  display: flex;\n  justify-content: flex-end;\n  padding: 20px;\n`;\n\nconst Name = styled.h2``;\n\nconst Modified = styled.div`\n  color: ${p => p.theme.color.disabled};\n`;\n\nconst Updated = styled.span`\n  ${p => p.theme.typography.sub}\n  text-align: right;\n`;\n\nconst Path = styled.span`\n  ${p => p.theme.typography.sub}\n  color: ${p => p.theme.color.secondary};\n`;\n\nconst Playlist = styled.div`\n  ${p => p.theme.typography.base}\n  align-items: center;\n  background-color: ${p =>\n    p.theme.color[p.isPlaying ? \"bgHighlight\" : \"background\"]};\n  border: none;\n  border-top: 1px solid ${p => p.theme.color.bgHighlight};\n  color: ${p => p.theme.color[p.isPlaying ? \"highlight\" : \"inherit\"]};\n  cursor: pointer;\n  display: grid;\n  grid-template-columns: 1fr auto;\n  line-height: 30px;\n  outline: none;\n  padding: ${p => p.theme.space.medium}px ${p => p.theme.space.large}px;\n  text-align: left;\n\n  :hover {\n    background-color: ${p => p.theme.color.primary}11;\n  }\n`;\n\nconst Title = styled.div`\n  display: grid;\n`;\n\nfunction Playlists() {\n  const playlists = usePlaylists({ forceRefresh: true });\n\n  return (\n    <div>\n      <Actions>\n        <ButtonLink to=\"new\">Add</ButtonLink>\n      </Actions>\n      <Loader isLoading={playlists.isLoading} />\n      <List\n        getKey={playlist => playlist.meta.id}\n        items={playlists.data}\n        itemRenderer={playlist => {\n          const modifiedBy = playlist.meta.user?.name?.display_name;\n          return (\n            <Link to={`playlist/${playlist.meta.id}`}>\n              <Playlist>\n                <Title>\n                  <Name>{playlist.data.title}</Name>\n                  {\n                    <Path>\n                      {playlist.data.artist || playlist.meta.path_display}\n                    </Path>\n                  }\n                </Title>\n                <Updated>\n                  Updated{\" \"}\n                  {formatRelative(\n                    new Date(playlist.meta.server_modified),\n                    new Date()\n                  )}\n                  <Modified>\n                    {Boolean(modifiedBy) ? \"by \" : \"\"}\n                    {modifiedBy}\n                  </Modified>\n                </Updated>\n              </Playlist>\n            </Link>\n          );\n        }}\n      />\n    </div>\n  );\n}\n\nexport default Playlists;\n","import React from \"react\";\n\nimport Playlists from \"./Playlists\";\n\nfunction Home() {\n  return <Playlists />;\n}\n\nexport default Home;\n","import React, { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\n\nconst Image = styled.img``;\n\nconst Name = styled.span`\n  font-size: 16px;\n`;\n\nconst Wrapper = styled.div`\n  align-items: center;\n  background-color: ${p => p.theme.color.primary};\n  border-radius: 50%;\n  color: ${p => p.theme.color.background};\n  display: flex;\n  justify-content: center;\n  height: ${p => p.size}px;\n  width: ${p => p.size}px;\n`;\n\nfunction Avatar({ initials, name, size = 36, url }) {\n  const [hasError, setHasError] = useState(false);\n\n  useEffect(() => {\n    if (url && hasError) {\n      setHasError(false);\n    }\n    // eslint-disable-next-line\n  }, [url]);\n\n  return (\n    <Wrapper size={size}>\n      {url && !hasError ? (\n        <Image\n          alt={name || initials}\n          onError={() => setHasError(true)}\n          src={url}\n        />\n      ) : (\n        <Name>{initials}</Name>\n      )}\n    </Wrapper>\n  );\n}\n\nexport default Avatar;\n","import React, { Fragment, useState } from \"react\";\nimport styled from \"styled-components\";\nimport Voicemail from \"@material-ui/icons/Voicemail\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\n\nimport { useDropbox } from \"../dropboxContext\";\nimport { HOME } from \"../constants\";\nimport Avatar from \"../Avatar\";\nimport Link from \"../Link\";\n\nconst Inner = styled.div`\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n`;\n\nconst Title = styled.h1`\n  padding-left: 10px;\n`;\n\nconst UserMenu = styled.button`\n  background: transparent;\n  border: none;\n  margin: 0;\n  outline: none;\n  padding: 0;\n`;\n\nconst Wrapper = styled.div`\n  align-items: center;\n  background-color: ${p => p.theme.color.backgroundLight};\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  padding: 20px;\n`;\nfunction Header({ location }) {\n  const [anchorEl, setAnchorEl] = useState(null);\n  const { currentUser, onLogout } = useDropbox();\n\n  function closeMenu() {\n    setAnchorEl(null);\n  }\n\n  function handleLogout() {\n    onLogout();\n  }\n\n  function showMenu(e) {\n    setAnchorEl(e.currentTarget);\n  }\n\n  return (\n    <Wrapper>\n      <Link to={HOME}>\n        <Inner>\n          <Voicemail fontSize=\"large\" />\n          <Title>Demo Tape</Title>\n        </Inner>\n      </Link>\n      <span />\n      {currentUser && (\n        <Fragment>\n          <UserMenu\n            aria-controls=\"user-menu\"\n            aria-haspopup=\"true\"\n            onClick={showMenu}\n          >\n            <Avatar\n              initials={currentUser?.name.abbreviated_name}\n              name={currentUser?.name.display_name}\n              url={currentUser?.profile_photo_url}\n            />\n          </UserMenu>\n          <Menu\n            elevation={0}\n            getContentAnchorEl={null}\n            anchorOrigin={{\n              vertical: \"bottom\",\n              horizontal: \"center\"\n            }}\n            transformOrigin={{\n              vertical: \"top\",\n              horizontal: \"center\"\n            }}\n            id=\"user-menu\"\n            anchorEl={anchorEl}\n            keepMounted={true}\n            open={Boolean(anchorEl)}\n            onClose={closeMenu}\n          >\n            <MenuItem onClick={() => handleLogout()}>Logout</MenuItem>\n          </Menu>\n        </Fragment>\n      )}\n    </Wrapper>\n  );\n}\n\nexport default Header;\n","import styled from \"styled-components\";\n\nconst size = 30;\n\nexport default styled.button`\n  background-color: ${p => p.theme.color.background};\n  border: ${p => (p.hideBorder ? \"none\" : \"1px solid white\")};\n  border-radius: 50%;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  height: ${p => p.size || size}px;\n  justify-content: center;\n  outline: none;\n  transition: ${p => p.theme.transition};\n  width: ${p => p.size || size}px;\n\n  :hover,\n  :focus {\n    background-color: white;\n    color: ${p => p.theme.color.background};\n  }\n\n  ${p =>\n    p.disabled\n      ? `\n    color: ${p.theme.color.disabled};\n    cursor: unset;\n    border-color: ${p.theme.color.transparent};\n\n    :hover, :focus {\n      background-color: ${p.theme.color.background};\n      color: ${p.theme.color.disabled};\n    }\n  `\n      : \"\"}\n`;\n","export function getMMSSFromMs(millis) {\n  const totalSeconds = millis / 1000;\n  const seconds = Math.floor(totalSeconds % 60);\n  const minutes = Math.floor(totalSeconds / 60);\n  return padWithZero(minutes) + \":\" + padWithZero(seconds);\n}\n\nfunction padWithZero(number) {\n  const string = number.toString();\n  if (number < 10) {\n    return \"0\" + string;\n  }\n  return string;\n}\n","import React, { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { useAudio } from \"../../audioContext\";\nimport { getMMSSFromMs } from \"./utils\";\n\nconst LeftTime = styled.span`\n  text-align: right;\n`;\n\nconst Wrapper = styled.div`\n  align-items: center;\n  color: ${p => p.theme.color[p.isDisabled ? \"disabled\" : \"primary\"]};\n  display: grid;\n  grid-template-columns: 80px 1fr 80px;\n  grid-gap: 5px;\n`;\n\nfunction Position() {\n  const audio = useAudio();\n  const [position, setPosition] = useState(0);\n  const [seekPosition, setSeekPosition] = useState(0);\n  const [isSeeking, setIsSeeking] = useState(false);\n\n  useEffect(() => {\n    audio.subscribeToProgress(setPosition);\n    // eslint-disable-next-line\n  }, [audio.subscribeToProgress]);\n\n  // if (!audio.track) return null;\n\n  function handleSeek(e) {\n    if (isSeeking) {\n      setSeekPosition(e.target.value);\n    } else {\n      const nextPosition = parseInt(seekPosition);\n      if (!isNaN(nextPosition)) {\n        audio.onSeek(nextPosition);\n        setPosition(nextPosition);\n      }\n    }\n  }\n\n  const displayPos = isSeeking ? seekPosition : position;\n\n  return (\n    <Wrapper isDisabled={!audio.track}>\n      <LeftTime>{getMMSSFromMs(displayPos)}</LeftTime>\n      <input\n        type=\"range\"\n        disabled={!audio.track}\n        min={0}\n        max={audio.duration}\n        onChange={handleSeek}\n        onMouseDown={e => {\n          setIsSeeking(true);\n        }}\n        onMouseUp={e => {\n          setIsSeeking(false);\n        }}\n        value={displayPos}\n      />\n      <span>{getMMSSFromMs(audio.duration)}</span>\n    </Wrapper>\n  );\n}\n\nexport default Position;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nimport { removeExtension } from \"../../utils\";\n\nconst Artist = styled.div`\n  ${p => p.theme.typography.sub}\n  color: ${p => p.theme.color.disabled};\n`;\n\nconst TrackName = styled.div`\n  ${p => p.theme.typography.base}\n  font-weight: 500;\n`;\n\nconst Wrapper = styled.div`\n  display: grid;\n  grid-gap: 2px;\n`;\n\nfunction SongDetails({ playlist, track }) {\n  return (\n    <Wrapper>\n      <TrackName>{removeExtension(track?.name)}</TrackName>\n      <Artist>\n        {playlist?.data?.data?.author || playlist?.data?.data?.title}\n      </Artist>\n    </Wrapper>\n  );\n}\n\nexport default SongDetails;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nimport Pause from \"@material-ui/icons/Pause\";\nimport PlayArrow from \"@material-ui/icons/PlayArrow\";\nimport SkipNext from \"@material-ui/icons/SkipNext\";\nimport SkipPrevious from \"@material-ui/icons/SkipPrevious\";\n\nimport { audioStates, useAudio } from \"../../audioContext\";\n\nimport IconButton from \"../../IconButton\";\nimport Position from \"./Position\";\nimport SongDetails from \"./SongDetails\";\n\nconst Buttons = styled.div`\n  align-items: center;\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 20px;\n  justify-content: center;\n`;\n\nconst Controls = styled.div`\n  display: flex;\n  justify-content: center;\n`;\n\nconst ControlsInner = styled.div`\n  display: grid;\n  flex: 1;\n  grid-gap: 5px;\n  max-width: 700px;\n`;\n\nconst Wrapper = styled.div`\n  align-items: center;\n  background-color: ${p => p.theme.color.backgroundLight};\n  bottom: 0;\n  display: grid;\n  grid-template-columns: 200px 1fr;\n  padding: 10px 20px;\n  position: absolute;\n  width: 100%;\n`;\n\nfunction Player() {\n  const audio = useAudio();\n\n  const hasTrack = !!audio.track;\n  const isPlaying = audio.state === audioStates.playing;\n  const isLoading = audio.state === audioStates.loading;\n\n  return (\n    <Wrapper>\n      <SongDetails playlist={audio.playlist} track={audio.track} />\n      <Controls>\n        <ControlsInner>\n          <Buttons>\n            <IconButton\n              aria-label=\"Previous\"\n              disabled={!audio.hasPrevious}\n              hideBorder\n              onClick={audio.onPrevious}\n            >\n              <SkipPrevious fontSize=\"small\" />\n            </IconButton>\n            {isPlaying ? (\n              <IconButton aria-label=\"Pause\" onClick={audio.onPause} size={40}>\n                <Pause />\n              </IconButton>\n            ) : (\n              <IconButton\n                aria-label=\"Play\"\n                disabled={isLoading || !hasTrack}\n                onClick={() => audio.onResume()}\n                size={40}\n              >\n                <PlayArrow />\n              </IconButton>\n            )}\n            <IconButton\n              aria-label=\"Next\"\n              disabled={!audio.hasNext}\n              hideBorder\n              onClick={audio.onNext}\n            >\n              <SkipNext fontSize=\"small\" />\n            </IconButton>\n          </Buttons>\n          <Position />\n        </ControlsInner>\n      </Controls>\n    </Wrapper>\n  );\n}\n\nexport default Player;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { Redirect } from \"@reach/router\";\n\nimport Header from \"./Header\";\nimport Player from \"./Player\";\nimport { useDropbox } from \"../dropboxContext\";\n\nconst Content = styled.main`\n  background-color: ${p => p.theme.color.background};\n  overflow-y: scroll;\n  padding-bottom: 113px;\n`;\n\nconst Wrapper = styled.div`\n  display: grid;\n  grid-template-rows: auto 1fr auto;\n  height: 100vh;\n  overflow: hidden;\n`;\n\nfunction Main({ children, location }) {\n  const { isAuthenticated } = useDropbox();\n\n  if (!isAuthenticated && location.pathname !== \"/auth\") {\n    return <Redirect noThrow={true} to=\"auth\" />;\n  }\n\n  return (\n    <Wrapper>\n      <Header location={location} />\n      <Content>{children}</Content>\n      <Player />\n    </Wrapper>\n  );\n}\n\nexport default Main;\n","import React, { useEffect, useState } from \"react\";\n\nimport Button from \"./Button\";\n\nfunction ConfirmationButton({ message, onClick, ...props }) {\n  const [isConfirming, setIsConfirming] = useState(false);\n\n  useEffect(() => {\n    const timeout = setTimeout(() => {\n      setIsConfirming(false);\n    }, 2000);\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [isConfirming]);\n\n  function onConfirm() {\n    setIsConfirming(true);\n  }\n\n  return isConfirming ? (\n    <Button onBlur={() => setIsConfirming(false)} onClick={onClick}>\n      {message || \"Are you sure?\"}\n    </Button>\n  ) : (\n    <Button onClick={onConfirm} {...props} />\n  );\n}\n\nexport default ConfirmationButton;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst Artist = styled.div`\n  ${p => p.theme.typography.sub}\n  color: ${p => p.theme.color.disabled};\n`;\n\nconst Info = styled.div`\n  display: grid;\n`;\n\nconst White = styled.span`\n  color: ${p => p.theme.color.primary};\n`;\n\nfunction PlaylistHeader({ playlist }) {\n  return (\n    <Info>\n      <h1>{playlist.data.title}</h1>\n      {playlist.data.artist && (\n        <Artist>\n          By <White>{playlist.data.artist}</White>\n        </Artist>\n      )}\n    </Info>\n  );\n}\n\nexport default PlaylistHeader;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport formatRelative from \"date-fns/formatRelative\";\n\nimport IconButton from \"../IconButton\";\n\nimport Delete from \"@material-ui/icons/Delete\";\nimport Headset from \"@material-ui/icons/Headset\";\nimport PlayArrow from \"@material-ui/icons/PlayArrow\";\n\nimport { removeExtension } from \"../utils\";\n\nconst Inner = styled.div`\n  align-items: center;\n  display: grid;\n  line-height: 30px;\n  grid-gap: 5px;\n  grid-template-columns: 40px 20px 1fr auto;\n  padding: ${p => p.theme.space.medium}px;\n`;\n\nconst Play = styled.span`\n  align-items: center;\n  border: 1px solid transparent;\n  border-radius: 50%;\n  color: ${p => (p.isPlaying ? \"white\" : \"transparent\")};\n  display: flex;\n  height: 30px;\n  justify-content: center;\n  line-height: 30px;\n  width: 30px;\n`;\n\nconst Updated = styled.span`\n  color: ${p => p.theme.color.secondary};\n  font-size: 11px;\n`;\n\nconst Wrapper = styled.button`\n${p => p.theme.typography.base}\nbackground-color: ${p =>\n  p.theme.color[p.isPlaying ? \"bgHighlight\" : \"background\"]};\n  border: none;\n  border-top: 1px solid ${p => p.theme.color.bgHighlight};\n  color: ${p => p.theme.color[p.isPlaying ? \"highlight\" : \"inherit\"]};\n  cursor: pointer;\n  outline: none;\n  text-align: left;\n  width: 100%;\n  \n  :hover {\n    background-color: ${p => p.theme.color.primary}11;\n    \n    #play {\n      border-color: white;\n      color: white;\n    }\n  }\n`;\n\nfunction Track({\n  index,\n  isEditable,\n  isPlaying,\n  onClick,\n  onDelete,\n  track,\n  user\n}) {\n  return (\n    <Wrapper\n      isPlaying={isPlaying}\n      onClick={isEditable ? undefined : () => onClick(track)}\n    >\n      <Inner>\n        {isEditable ? (\n          <IconButton onClick={() => onDelete(track)}>\n            <Delete fontSize=\"small\" />\n          </IconButton>\n        ) : (\n          <Play id=\"play\" isPlaying={isPlaying}>\n            {isPlaying ? (\n              <Headset fontSize=\"small\" />\n            ) : (\n              <PlayArrow fontSize=\"small\" />\n            )}\n          </Play>\n        )}\n        <span>{index}.</span>\n        <span>{removeExtension(track.name)}</span>\n        {isEditable ? (\n          <div />\n        ) : (\n          <Updated>\n            Updated{\" \"}\n            {formatRelative(new Date(track.server_modified), new Date())}\n            {user ? ` by ${user.name.full}` : \"\"}\n          </Updated>\n        )}\n      </Inner>\n    </Wrapper>\n  );\n}\n\nexport default Track;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\nimport DragIndicator from \"@material-ui/icons/DragIndicator\";\n\nimport List from \"../List\";\nimport Track from \"./Track\";\n\nimport { reorderList } from \"../utils\";\n\nconst DragHandle = styled.div`\n  align-items: center;\n  color: ${p => p.theme.color.primary};\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  position: absolute;\n  right: 10px;\n  top: 0;\n`;\n\nconst TrackWrapper = styled.div`\n  position: relative;\n`;\n\nfunction trackListPropsAreEqual(prev, next) {\n  return (\n    prev.playingId === next.playingId &&\n    prev.tracks.map(t => t.id).join() === next.tracks.map(t => t.id).join()\n  );\n}\n\nconst EditableTrackList = React.memo(function EditableTrackList({\n  onTrackClick,\n  onTrackDelete,\n  playingId,\n  tracks\n}) {\n  return (\n    <List\n      getKey={t => t.id}\n      items={tracks}\n      itemRenderer={(track, index) => (\n        <Draggable draggableId={track.id} index={index}>\n          {provided => (\n            <TrackWrapper ref={provided.innerRef} {...provided.draggableProps}>\n              <Track\n                index={index + 1}\n                isEditable={true}\n                isPlaying={playingId === track.id}\n                onClick={onTrackClick}\n                onDelete={onTrackDelete}\n                track={track}\n              />\n              <DragHandle {...provided.dragHandleProps}>\n                <DragIndicator />\n              </DragHandle>\n            </TrackWrapper>\n          )}\n        </Draggable>\n      )}\n    />\n  );\n},\ntrackListPropsAreEqual);\n\nfunction TrackList({\n  isEditing,\n  onTrackChange,\n  onTrackClick,\n  onTrackDelete,\n  playingId,\n  tracks\n}) {\n  function handleSort(result) {\n    if (\n      !result.destination ||\n      result.destination.index === result.source.index\n    ) {\n      return;\n    }\n\n    const reordered = reorderList(\n      tracks,\n      result.source.index,\n      result.destination.index\n    );\n\n    onTrackChange(reordered);\n  }\n\n  function handleDelete(track) {\n    onTrackChange(tracks.filter(t => t.id !== track.id));\n  }\n\n  return isEditing ? (\n    <DragDropContext onDragEnd={handleSort}>\n      <Droppable droppableId=\"tracks\">\n        {provided => (\n          <div ref={provided.innerRef} {...provided.droppableProps}>\n            <EditableTrackList\n              onTrackClick={onTrackClick}\n              onTrackDelete={handleDelete}\n              playingId={playingId}\n              tracks={tracks}\n            />\n            {provided.placeholder}\n          </div>\n        )}\n      </Droppable>\n    </DragDropContext>\n  ) : (\n    <List\n      getKey={t => t.id}\n      items={tracks}\n      itemRenderer={(track, index) => (\n        <Track\n          index={index + 1}\n          isPlaying={playingId === track.id}\n          onClick={onTrackClick}\n          track={track}\n        />\n      )}\n    />\n  );\n}\n\nexport default TrackList;\n","import React, { Fragment, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { HOME } from \"../constants\";\nimport Button from \"../Button\";\nimport ButtonLink from \"../ButtonLink\";\nimport ConfirmationButton from \"../ConfirmationButton\";\nimport Loader from \"../Loader\";\nimport PlaylistHeader from \"../PlaylistHeader\";\nimport TextInput from \"../TextInput\";\nimport TrackList from \"./TrackList\";\n\nimport { useAudio } from \"../audioContext\";\nimport usePlaylist from \"../usePlaylist\";\n\nconst Actions = styled.div`\n  align-items: center;\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: 20px;\n`;\n\nconst Add = styled.div`\n  align-items: center;\n  display: grid;\n  grid-template-columns: 110px auto;\n  justify-content: flex-start;\n  padding: 20px;\n`;\n\nconst Header = styled.div`\n  align-items: ${p => (p.isEditing ? \"flex-start\" : \"center\")};\n  display: grid;\n  grid-auto-flow: column;\n  grid-gap: ${p => (p.isEditing ? 40 : 20)}px;\n  grid-template-columns: 1fr auto;\n  padding: 20px;\n`;\n\nconst Inputs = styled.div`\n  display: grid;\n  grid-gap: 20px;\n`;\n\nfunction Playlist({ navigate, playlistId }) {\n  const { data, isLoading, onDelete, onSave } = usePlaylist({ playlistId });\n  const [isDirty, setIsDirty] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [playlist, setPlaylist] = useState(data);\n  const audio = useAudio();\n\n  function handleCancelEdit() {\n    setIsDirty(false);\n    setIsEditing(false);\n    setPlaylist(data);\n  }\n\n  async function handleDelete() {\n    await onDelete(playlist);\n    navigate(HOME);\n  }\n\n  function handleTrackChange(tracks) {\n    setPlaylist({\n      ...playlist,\n      data: {\n        ...playlist.data,\n        tracks\n      }\n    });\n    setIsDirty(true);\n  }\n\n  function handleToggleEdit() {\n    if (isEditing) {\n      if (isDirty) {\n        onSave(playlist);\n      }\n      setIsDirty(false);\n      setIsEditing(false);\n    } else {\n      setIsEditing(true);\n      setPlaylist(data);\n    }\n  }\n\n  function handleArtistChange(artist) {\n    setPlaylist({\n      ...playlist,\n      data: {\n        ...playlist.data,\n        artist\n      }\n    });\n    setIsDirty(true);\n  }\n\n  function handleTitleChange(title) {\n    setPlaylist({\n      ...playlist,\n      data: {\n        ...playlist.data,\n        title\n      }\n    });\n    setIsDirty(true);\n  }\n\n  function handleTrackClick(track) {\n    audio.onPlay({ playlistId, trackId: track.id });\n  }\n\n  return (\n    <div>\n      {isEditing ? (\n        <Header isEditing={isEditing}>\n          <Inputs>\n            <TextInput\n              onChange={handleTitleChange}\n              title=\"Title\"\n              value={playlist.data.title}\n            />\n            <TextInput\n              onChange={handleArtistChange}\n              title=\"Artist\"\n              value={playlist.data.artist || \"\"}\n            />\n          </Inputs>\n          <Actions>\n            <Fragment>\n              <Button disabled={!isDirty} onClick={handleToggleEdit}>\n                Save\n              </Button>\n              <Button onClick={handleCancelEdit}>Cancel</Button>\n            </Fragment>\n          </Actions>\n        </Header>\n      ) : (\n        <Header isEditing={isEditing}>\n          <PlaylistHeader playlist={playlist} />\n          <Actions>\n            <Button onClick={handleToggleEdit}>Edit</Button>\n            <ConfirmationButton message=\"Really Delete?\" onClick={handleDelete}>\n              Delete\n            </ConfirmationButton>\n          </Actions>\n        </Header>\n      )}\n      {isEditing && (\n        <Add>\n          <h2>Tracks</h2>\n          <ButtonLink to=\"tracks\">Add Tracks</ButtonLink>\n        </Add>\n      )}\n      <Loader isLoading={isLoading} />\n      <TrackList\n        isEditing={isEditing}\n        onTrackChange={handleTrackChange}\n        onTrackClick={handleTrackClick}\n        playingId={audio.track?.id}\n        tracks={playlist.data.tracks}\n      />\n    </div>\n  );\n}\n\nexport default Playlist;\n","import React, { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useNavigate } from \"@reach/router\";\n\nimport Button from \"./Button\";\nimport ButtonLink from \"./ButtonLink\";\nimport Explorer from \"./Explorer\";\nimport usePlaylist from \"./usePlaylist\";\nimport PlaylistHeader from \"./PlaylistHeader\";\n\nconst Header = styled.div`\n  display: grid;\n  flex-direction: row;\n  grid-gap: 20px;\n  grid-template-columns: 1fr auto auto;\n  padding: 20px;\n`;\n\nfunction Tracks({ playlistId }) {\n  const { data: playlist, isLoading, onSave } = usePlaylist({ playlistId });\n  const [selectedTracks, setSelectedTracks] = useState([]);\n  const [isDirty, setIsDirty] = useState(false);\n  const navigate = useNavigate();\n  const playlistUrl = `/playlist/${playlistId}`;\n\n  useEffect(() => {\n    setSelectedTracks(playlist?.data?.tracks || []);\n  }, [isLoading, playlist]);\n\n  function handleSave() {\n    onSave({\n      ...playlist,\n      data: {\n        ...playlist.data,\n        tracks: selectedTracks\n      }\n    });\n    navigate(playlistUrl);\n  }\n\n  function handleSelectionChange(tracks) {\n    setSelectedTracks(tracks);\n    if (!isDirty) {\n      setIsDirty(true);\n    }\n  }\n\n  return (\n    <div>\n      <Header>\n        <PlaylistHeader playlist={playlist} />\n        <Button disabled={!isDirty} onClick={handleSave}>\n          Save\n        </Button>\n        <ButtonLink to={playlistUrl}>Cancel</ButtonLink>\n      </Header>\n      <Explorer\n        onSelectionChange={handleSelectionChange}\n        selectedEntries={selectedTracks}\n        showFiles={true}\n      />\n    </div>\n  );\n}\n\nexport default Tracks;\n","import React from \"react\";\nimport { Router } from \"@reach/router\";\nimport { ThemeProvider } from \"styled-components\";\nimport {\n  ThemeProvider as MuiThemeProvider,\n  createMuiTheme\n} from \"@material-ui/core/styles\";\nimport blue from \"@material-ui/core/colors/blue\";\n\nimport { AudioProvider } from \"./audioContext\";\nimport { CacheProvider } from \"./cacheContext\";\nimport { DropboxProvider } from \"./dropboxContext\";\nimport { HOME } from \"./constants\";\nimport theme from \"./theme\";\n\nimport Auth from \"./Auth\";\nimport AddPlaylist from \"./AddPlaylist\";\nimport Home from \"./Home\";\nimport Main from \"./Main\";\nimport Playlist from \"./Playlist\";\nimport Tracks from \"./Tracks\";\n\nconst muiTheme = createMuiTheme({\n  palette: {\n    primary: blue\n  }\n});\n\nfunction App() {\n  return (\n    <MuiThemeProvider theme={muiTheme}>\n      <ThemeProvider theme={theme}>\n        <CacheProvider>\n          <DropboxProvider authUrl={`${window.location.href}`}>\n            <AudioProvider>\n              <Router>\n                <Main path={HOME}>\n                  <Auth path=\"auth\" />\n                  <AddPlaylist path=\"new\" />\n                  <Playlist path=\"playlist/:playlistId\" />\n                  <Tracks path=\"playlist/:playlistId/tracks\" />\n                  <Home path=\"/\" />\n                </Main>\n              </Router>\n            </AudioProvider>\n          </DropboxProvider>\n        </CacheProvider>\n      </ThemeProvider>\n    </MuiThemeProvider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}